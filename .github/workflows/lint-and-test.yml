name: Reusable lint-and-test workflow

on:
  workflow_call:

jobs:
    lint-and-test:
      runs-on: ubuntu-latest
      steps:
        - name: Check out repository code  ðŸ“¥
          uses: actions/checkout@v3
        - name: Setup node ðŸ”§
          uses: actions/setup-node@v3
          with:
            node-version: 20.9.0
            cache: npm
        - name: Install dependencies ðŸ“¦
          run: |
            npm ci
        - name: Lint the repository ðŸ”¬
          run: |
            npm run lint
        - name: Run tests ðŸ”¬
          env:
            DM_STORE_AVAILABILITY_API: ${{ vars.DM_STORE_AVAILABILITY_API }}
            DM_PRODUCT_SEARCH_API: ${{ vars.DM_PRODUCT_SEARCH_API }}
            ROSSMANN_PRODUCT_SEARCH_API: ${{ vars.ROSSMANN_PRODUCT_SEARCH_API }}
            ROSSMANN_STORE_AVAILABILITY_API: ${{ vars.ROSSMANN_STORE_AVAILABILITY_API }}
          run: |
            npm run test:coverage
        - run: echo "Done ðŸŽ‰"
